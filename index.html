<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buyer's Closing Costs Calculator</title>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
  
  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Babel for converting JSX in browser -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    body { font-family: 'Inter', sans-serif; }
    .font-serif { font-family: 'Playfair Display', serif; }
    
    /* Animation classes */
    .animate-fade-in {
      animation: fadeIn 0.5s ease-out forwards;
    }
    .animate-fade-in-up {
      animation: fadeInUp 0.5s ease-out forwards;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.4",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "lucide-react": "https://esm.sh/lucide-react@^0.563.0",
    "react/": "https://esm.sh/react@^19.2.4/",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.4"
  }
}
</script>
</head>
<body class="bg-slate-50 text-slate-900">
  <div id="app"></div>

  <script type="text/babel">
    const { useState } = React;
    const { createRoot } = ReactDOM;

    // --- Icons (Inline SVG components to avoid dependencies) ---
    const FileText = ({ className }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>
    );

    const Calculator = ({ className }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>
    );

    const HelpCircle = ({ className }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></svg>
    );

    // --- Data ---
    const provinces = [
      { id: 'ab', name: 'Alberta', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f5/Flag_of_Alberta.svg/1000px-Flag_of_Alberta.svg.png' },
      { id: 'bc', name: 'BC', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/Flag_of_British_Columbia.svg/800px-Flag_of_British_Columbia.svg.png' },
      { id: 'mb', name: 'Manitoba', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c4/Flag_of_Manitoba.svg/800px-Flag_of_Manitoba.svg.png' },
      { id: 'nb', name: 'New Brunswick', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/f/fb/Flag_of_New_Brunswick.svg/800px-Flag_of_New_Brunswick.svg.png' },
      { id: 'nl', name: 'Newfoundland', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/dd/Flag_of_Newfoundland_and_Labrador.svg/800px-Flag_of_Newfoundland_and_Labrador.svg.png' },
      { id: 'ns', name: 'Nova Scotia', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c0/Flag_of_Nova_Scotia.svg/800px-Flag_of_Nova_Scotia.svg.png' },
      { id: 'on', name: 'Ontario', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/Flag_of_Ontario.svg/800px-Flag_of_Ontario.svg.png' },
      { id: 'pe', name: 'PEI', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Flag_of_Prince_Edward_Island.svg/800px-Flag_of_Prince_Edward_Island.svg.png' },
      { id: 'qc', name: 'Quebec', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Flag_of_Quebec.svg/800px-Flag_of_Quebec.svg.png' },
      { id: 'sk', name: 'Saskatchewan', flagUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Flag_of_Saskatchewan.svg/800px-Flag_of_Saskatchewan.svg.png' },
    ];

    // --- Components ---

    const Header = () => (
      <header className="w-full bg-[#fdfdfd] bg-[radial-gradient(#e5e7eb_1px,transparent_1px)] [background-size:20px_20px] py-16 px-4 flex flex-col items-center text-center border-b border-slate-200 mb-8">
         {/* Logo Section */}
         <div className="flex items-baseline justify-center gap-2 mb-3">
            <h1 className="text-5xl md:text-7xl font-serif font-bold text-[#c5a059] tracking-tight leading-none">
              Kousha Law
            </h1>
            <span className="text-2xl md:text-3xl font-serif font-bold text-[#c5a059] leading-none">P.C.</span>
         </div>
         
         {/* Divider and Subtitle */}
         <div className="flex items-center justify-center w-full max-w-sm gap-4 mb-10">
           <div className="h-px bg-[#c5a059] flex-1"></div>
           <span className="text-slate-500 uppercase tracking-[0.2em] text-xs font-semibold whitespace-nowrap">Barrister & Solicitor</span>
           <div className="h-px bg-[#c5a059] flex-1"></div>
         </div>

         <h2 className="text-4xl md:text-5xl font-serif font-bold text-slate-900 mb-6">
           Buyer's Closing Costs Calculator
         </h2>
         <p className="text-slate-600 text-lg md:text-xl font-light max-w-3xl mx-auto">
           Estimate your total cash required and avoid surprises on closing day.
         </p>
      </header>
    );

    const Footer = () => (
      <footer className="w-full bg-[#fdfdfd] bg-[radial-gradient(#e5e7eb_1px,transparent_1px)] [background-size:20px_20px] py-12 mt-auto border-t border-slate-100">
        <div className="flex flex-col items-center justify-center gap-3 text-center px-4">
          <p className="text-[#94a3b8] text-[15px] font-normal">
            &copy; 2026 Kousha Law P.C. . All rights reserved.
          </p>
          <p className="text-[#94a3b8] text-[15px] font-normal">
            Designed By Arash Ashouri +1(416)221-2120
          </p>
        </div>
      </footer>
    );

    const CurrencyInput = ({ label, value, onChange, helpContent }) => {
      const [showTooltip, setShowTooltip] = useState(false);

      const handleChange = (e) => {
        const rawValue = e.target.value.replace(/[^0-9.]/g, '');
        if ((rawValue.match(/\./g) || []).length > 1) return;
        const numValue = rawValue === '' ? 0 : parseFloat(rawValue);
        onChange(numValue);
      };

      return (
        <div className="flex flex-col gap-1 w-full max-w-xs">
          <div className="flex items-center gap-2 text-slate-500 text-sm mb-1">
            <span>{label}</span>
            {helpContent && (
              <div 
                className="relative flex items-center"
                onMouseEnter={() => setShowTooltip(true)}
                onMouseLeave={() => setShowTooltip(false)}
              >
                <HelpCircle className="w-4 h-4 text-slate-400 hover:text-[#c5a059] cursor-help transition-colors" />
                <div className={`
                  absolute bottom-full left-1/2 -translate-x-1/2 mb-3 w-64 p-4 bg-[#2c3e50] text-white text-sm rounded-lg shadow-xl text-center transition-all duration-200 pointer-events-none z-50
                  ${showTooltip ? 'opacity-100 translate-y-0 visible' : 'opacity-0 translate-y-2 invisible'}
                `}>
                   {helpContent}
                   <div className="absolute top-full left-1/2 -translate-x-1/2 -mt-px border-8 border-transparent border-t-[#2c3e50]"></div>
                </div>
              </div>
            )}
          </div>
          <div className="relative flex items-center border-b border-slate-300 focus-within:border-[#c5a059] transition-colors pb-1">
            <span className="text-[#c5a059] font-bold text-xl mr-2">$</span>
            <input
              type="text"
              value={value === 0 ? '' : value.toLocaleString()}
              onChange={handleChange}
              placeholder="0"
              className="w-full outline-none text-xl text-slate-800 font-medium bg-transparent placeholder-slate-300"
            />
          </div>
        </div>
      );
    };

    const PercentageInput = ({ label, value, onChange, showHelp = false }) => {
      const handleChange = (e) => {
        const rawValue = e.target.value.replace(/[^0-9.]/g, '');
        if ((rawValue.match(/\./g) || []).length > 1) return;
        const numValue = rawValue === '' ? 0 : parseFloat(rawValue);
        onChange(numValue);
      };

      return (
        <div className="flex flex-col gap-1 w-full max-w-xs">
          <div className="flex items-center gap-2 text-slate-500 text-sm mb-1">
            <span>{label}</span>
            {showHelp && <HelpCircle className="w-4 h-4 text-slate-400 cursor-help" />}
          </div>
          <div className="relative flex items-center border-b border-slate-300 focus-within:border-[#c5a059] transition-colors pb-1">
            <input
              type="text"
              value={value === 0 ? '' : value.toString()}
              onChange={handleChange}
              placeholder="0"
              className="w-full outline-none text-xl text-slate-800 font-medium bg-transparent placeholder-slate-300"
            />
            <span className="text-[#c5a059] font-bold text-xl ml-2">%</span>
          </div>
        </div>
      );
    };

    const App = () => {
      const [selectedProvince, setSelectedProvince] = useState(null);
      const [results, setResults] = useState(null);
      
      const [soldPrice, setSoldPrice] = useState(500000);
      const [legalFees, setLegalFees] = useState(1300);
      const [commissionRate, setCommissionRate] = useState(5);

      const activeProvinces = ['ab', 'bc', 'mb', 'nb', 'nl', 'ns', 'on', 'pe', 'qc', 'sk'];
      const showInputs = selectedProvince && activeProvinces.includes(selectedProvince);

      const handleProvinceSelect = (id) => {
        setSelectedProvince(id);
        setResults(null); 
      };

      const handleCalculate = () => {
        if (!selectedProvince) return;

        let totalCommission = 0;
        let buyingAgent = 0;
        let sellingAgent = 0;
        let taxRate = 0;

        if (selectedProvince === 'ab') {
          if (soldPrice <= 100000) {
            totalCommission = soldPrice * 0.07;
          } else {
            totalCommission = (100000 * 0.07) + ((soldPrice - 100000) * 0.03);
          }
          taxRate = 0.05;
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        } else if (selectedProvince === 'bc') {
          if (soldPrice <= 100000) {
            totalCommission = soldPrice * 0.07;
            buyingAgent = soldPrice * 0.03125;
          } else {
            totalCommission = (100000 * 0.07) + ((soldPrice - 100000) * 0.025);
            buyingAgent = (100000 * 0.03125) + ((soldPrice - 100000) * 0.011625);
          }
          sellingAgent = totalCommission - buyingAgent;
          taxRate = 0.05; 
        } else if (selectedProvince === 'mb') {
          totalCommission = soldPrice * (commissionRate / 100);
          taxRate = 0.05; 
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        } else if (selectedProvince === 'nb') {
          totalCommission = soldPrice * (commissionRate / 100);
          taxRate = 0.15;
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        } else if (selectedProvince === 'nl') {
          totalCommission = soldPrice * (commissionRate / 100);
          taxRate = 0.15;
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        } else if (selectedProvince === 'ns') {
          totalCommission = soldPrice * (commissionRate / 100);
          taxRate = 0.15;
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        } else if (selectedProvince === 'on') {
          totalCommission = soldPrice * (commissionRate / 100);
          taxRate = 0.13;
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        } else if (selectedProvince === 'pe') {
          totalCommission = soldPrice * (commissionRate / 100);
          taxRate = 0.15;
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        } else if (selectedProvince === 'qc') {
          totalCommission = soldPrice * (commissionRate / 100);
          taxRate = 0.14975;
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        } else if (selectedProvince === 'sk') {
          if (soldPrice <= 100000) {
            totalCommission = soldPrice * 0.06;
          } else {
            totalCommission = (100000 * 0.06) + ((soldPrice - 100000) * 0.025);
          }
          taxRate = 0.05;
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        } else {
          totalCommission = soldPrice * (commissionRate / 100);
          taxRate = 0.13; 
          buyingAgent = totalCommission / 2;
          sellingAgent = totalCommission / 2;
        }

        const tax = totalCommission * taxRate;
        const totalCosts = totalCommission + tax + legalFees;
        const receive = soldPrice - totalCosts;

        setResults({
          totalCosts,
          receive,
          buyingAgent,
          sellingAgent,
          tax,
          legalFees
        });
      };

      return (
        <div className="min-h-screen flex flex-col bg-slate-50 font-sans">
          
          <Header />

          <main className="flex-grow pb-8 px-4 sm:px-6 lg:px-8">
            <div className="max-w-5xl mx-auto space-y-8">
              
              {/* Inputs Section */}
              <div className="bg-white border border-slate-200 shadow-sm rounded-lg overflow-hidden">
                <div className="bg-[#2c3e50] text-white px-6 py-4 flex items-center gap-2">
                  <FileText className="w-6 h-6 text-[#c5a059] flex-shrink-0" />
                  <h2 className="text-xl font-bold">Please specify the province where your property is situated.</h2>
                  <div className="w-3 h-3 rounded-full bg-[#c5a059] ml-1 flex-shrink-0"></div>
                </div>
                
                <div className="p-8 bg-white">
                  <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-8">
                    {provinces.map((province) => (
                      <button
                        key={province.id}
                        onClick={() => handleProvinceSelect(province.id)}
                        className="group flex flex-col items-center focus:outline-none"
                      >
                        <div className={`
                          relative w-full aspect-[3/2] shadow-sm transition-all duration-200 
                          ${selectedProvince === province.id 
                            ? 'ring-4 ring-[#c5a059] scale-105' 
                            : 'group-hover:scale-105 group-hover:shadow-md'
                          }
                        `}>
                          <img 
                            src={province.flagUrl} 
                            alt={`${province.name} flag`}
                            className="w-full h-full object-cover border border-slate-200"
                            loading="lazy"
                          />
                        </div>
                        <span className={`
                          mt-3 text-center font-medium text-lg transition-colors
                          ${selectedProvince === province.id ? 'text-[#c5a059] font-bold' : 'text-slate-600 group-hover:text-slate-900'}
                        `}>
                          {province.name}
                        </span>
                      </button>
                    ))}
                  </div>
                </div>
              </div>

              {/* Dynamic Content */}
              {showInputs ? (
                <div className="animate-fade-in bg-white border border-slate-200 shadow-sm rounded-lg p-8">
                   <div className="flex flex-col items-center">
                     <h3 className="text-3xl text-[#2c3e50] font-light mb-8 pb-4 border-b border-slate-100 w-full text-center">
                      {provinces.find(p => p.id === selectedProvince)?.name}
                     </h3>
                     <div className="flex flex-col md:flex-row justify-center gap-12 md:gap-20 w-full max-w-5xl">
                        {['mb', 'nb', 'nl', 'ns', 'on', 'pe', 'qc'].includes(selectedProvince) && (
                          <PercentageInput
                            label="Total Commission Rate"
                            value={commissionRate}
                            onChange={setCommissionRate}
                          />
                        )}
                        <CurrencyInput 
                          label="Purchase Price" 
                          value={soldPrice} 
                          onChange={setSoldPrice} 
                        />
                        <CurrencyInput 
                          label="Legal Fees" 
                          value={legalFees} 
                          onChange={setLegalFees}
                          helpContent={
                            <span>
                              You can expect to incur a value of <strong>$900 to $1,600</strong> on legal fees, which account for the preparation and recording of official documents.
                            </span>
                          }
                        />
                     </div>
                     
                     <div className="mt-12">
                       <button 
                        onClick={handleCalculate}
                        className="bg-[#c5a059] hover:bg-[#b08d4b] text-white text-xl font-medium py-3 px-8 rounded shadow-sm transition-colors"
                       >
                         Calculate Your Closing Costs
                       </button>
                     </div>
                   </div>
                </div>
              ) : selectedProvince && (
                <div className="animate-fade-in p-6 bg-blue-50 border border-blue-200 rounded-lg text-center text-blue-800">
                   Additional input fields for <strong>{provinces.find(p => p.id === selectedProvince)?.name}</strong> will be loaded here.
                </div>
              )}

              {/* Results Section */}
              {results && (
                <div className="animate-fade-in-up bg-white border border-slate-200 shadow-sm rounded-lg overflow-hidden">
                   <div className="bg-[#2c3e50] text-white py-4 px-6 flex items-center justify-center gap-2">
                     <Calculator className="w-8 h-8 text-[#c5a059]" />
                     <h3 className="text-3xl font-bold tracking-tight">Results</h3>
                   </div>
                   
                   <div className="p-8 md:p-12">
                     {/* Summary Row */}
                     <div className="flex flex-col md:flex-row justify-between items-center gap-10 mb-10">
                        <div className="text-center w-full">
                           <p className="text-slate-600 text-lg mb-2 font-medium">Total closing costs</p>
                           <p className="text-4xl sm:text-5xl font-bold text-slate-800 tracking-tight">
                             $ {results.totalCosts.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}
                           </p>
                        </div>
                        <div className="text-center w-full">
                           <p className="text-slate-600 text-lg mb-2 font-medium">You will receive</p>
                           <p className="text-4xl sm:text-5xl font-bold text-slate-800 tracking-tight">
                             $ {results.receive.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}
                           </p>
                        </div>
                     </div>

                     {/* Divider with Text */}
                     <div className="relative flex py-8 items-center">
                        <div className="flex-grow border-t border-slate-200"></div>
                        <span className="flex-shrink-0 mx-6 text-slate-800 font-semibold text-xl">Closing Cost Breakdown</span>
                        <div className="flex-grow border-t border-slate-200"></div>
                     </div>

                     {/* Detailed Breakdown */}
                     <div className="grid grid-cols-2 md:grid-cols-4 gap-y-8 gap-x-4">
                        <div className="text-center">
                           <p className="text-slate-500 text-sm mb-1">Buying Agent</p>
                           <p className="text-2xl font-bold text-slate-800">
                             $ {results.buyingAgent.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}
                           </p>
                        </div>
                        <div className="text-center">
                           <p className="text-slate-500 text-sm mb-1">Selling Agent</p>
                           <p className="text-2xl font-bold text-slate-800">
                             $ {results.sellingAgent.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}
                           </p>
                        </div>
                        <div className="text-center">
                           <p className="text-slate-500 text-sm mb-1">Sales Tax on Agent Commissions</p>
                           <p className="text-2xl font-bold text-slate-800">
                             $ {results.tax.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}
                           </p>
                        </div>
                        <div className="text-center">
                           <p className="text-slate-500 text-sm mb-1">Legal Fees</p>
                           <p className="text-2xl font-bold text-slate-800">
                             $ {results.legalFees.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})}
                           </p>
                        </div>
                     </div>
                   </div>
                </div>
              )}

            </div>
          </main>

          <Footer />

        </div>
      );
    };

    const root = createRoot(document.getElementById('app'));
    root.render(<App />);
  </script>
</body>
</html>